<a href="/inventories">
  Back to all inventory
</a>
<br>


<div class="row mb-3">
  <div class="col-md-8 offset-md-2">
    <h1>
      <%= @wine.vintage %> <%= @wine.vineyard %> <%= @wine.blend %>
    </h1>
  </div>
</div>

<div class="row mb-3">
  <div class="col-md-8 offset-md-2">
    <img src="<%= @wine.photo_url %>" height="250">
  </div>
</div>

<%# Display info %>

<div>
  <%# Inventory info %>
  <div class="row">
    <div class="col-md-4">
        <b>Location</b>
      <br>
        <%= @inventory.location %>
    </div>
    <div class="col-md-4">
        <b>Price</b>
      <br>
        <%= number_to_currency(@inventory.price) %>
    </div>
    <div class="col-md-4">
        <b>Still in inventory?</b>
      <br>
        <% if @alive == true %>
          <i class="fas fa-check"></i>
          <a href="/remove_inventory/<%= @inventory.id %>" class="btn btn-block btn-outline-secondary">
          Remove inventory
          </a>
        <% else %>
          <i class="fas fa-minus-circle"></i>
        <% end %>
    </div>
  </div>

  <br>
  <br>

  <%# Expert info %>
  <h2>Expert information</h2>
  <div class="row">
    <div class="col-md-4">
        <b>Rating</b>
      <br>
        <% if @wine.expert_rating == nil %>
          No expert rating
        <% else %>
          <% if @wine.expert_rating == 5 %>
            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
          <% elsif @wine.expert_rating >= 4 %>
            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="far fa-star"></i>
          <% elsif @wine.expert_rating >= 3 %>
            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i>
          <% elsif @wine.expert_rating >= 2 %>
            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i>
          <% elsif @wine.expert_rating >= 1 %>
            <i class="fas fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i>
          <% else %>
            <i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i>
          <% end %>
          <%= @wine.expert_rating.to_f %>
        <% end %>
    </div>
    <div class="col-md-4">
        <b>Notes</b>
      <br>
        <%= @wine.expert_notes %>
    </div>
    <div class="col-md-4">
        <a href="<%= @wine.external_url %>">More info</a> <i class="fas fa-external-link-alt"></i>
    </div>
  </div>

<br>
<hr>

  <%# User ratings info %>
  <h2>Our information</h2>
  <div class="row">
    <div class="col-md-4">
        <b>Our rating</b>
      <br>
        <% if @avg_rating == 5 %>
          <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
        <% elsif @avg_rating >= 4 %>
          <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="far fa-star"></i>
        <% elsif @avg_rating >= 3 %>
          <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i>
        <% elsif @avg_rating >= 2 %>
          <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i>
        <% elsif @avg_rating >= 1 %>
          <i class="fas fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i>
        <% else %>
          <i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i>
        <% end %>
        <%= @avg_rating %>
    </div>
    <div class="col-md-4">
        <b>Tags</b>
      <br>
        <% if @tags_count != 0 %>
          <%= @tags.to_sentence %>
        <% else %>
          No tags yet
        <% end %>
    </div>
    <div class="col-md-4">
        <b>Comments</b>
      <br>
        <% if @comments.count == 0 %>
          No comments yet
        <% else %>
          <table class="table">
            <% @comments.each do |comment| %>
              <tr>
                <td>
                  <%= comment.comment %>
                </td>
                <td>
                  <%= comment.commenter_name %>
                </td>
              </tr>
            <% end %>
          </table>
        <% end %>
    </div>
  </div>

</div>

<hr>
<%# USER ACTIONS %>
<div class="row">
  <%# Allow rating %>
  <div class="col-md-4">
    <form action="/insert_user_rating" method="post">
      <div class="form-group">
        <input type="hidden" id="inventory_id" name="inventory_id_from_query" class="form-control" value=<%= @inventory.id%>>
      </div>
      <div class="form-group">
          <input type="hidden" id="wine_id_box" name="wine_id_from_query" class="form-control" value=<%= @inventory.wine_id%>>
      </div>
      <div class="form-group">
          <div class="row">
            <%# 1 star %>
              <input type="radio" id="1_stars" value="1" name="rating_from_query">
                <label for="1_stars">
                  <i class="fas fa-star"></i>
                </label>
            <%# 2 star %>
              <input type="radio" id="2_stars" value="2" name="rating_from_query">
                <label for="2_stars">
                  <i class="fas fa-star"></i><i class="fas fa-star"></i>
                </label>
            <%# 3 star %>
              <input type="radio" id="3_stars" value="3" name="rating_from_query">
                <label for="3_stars">
                  <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                </label>
            <%# 4 star %>
              <input type="radio" id="4_stars" value="4" name="rating_from_query">
                <label for="4_stars">
                  <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                </label>
            <%# 5 star %>
              <input type="radio" id="5_stars" value="5" name="rating_from_query">
                <label for="5_stars">
                  <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                </label>
          </div>
        </div>

        <button class="btn btn-block btn-outline-secondary">
          Submit rating
        </button>
      </form>
  </div>
  
  <%# Allow tagging %>
  <div class="col-md-4"> 
    <form action="/insert_tag" method="post">
      
      <div class="form-group">
        <input type="hidden" id="inventory_id" name="inventory_id_from_query" class="form-control" value=<%= @inventory.id%>>
      </div>

      <div class="form-group">
        <input type="hidden" id="wine_id_box" name="wine_id_from_query" class="form-control" value=<%= @inventory.wine_id%>>
      </div>

      <div class="form-group">
        <label for="tag_box">
          Add a tag
        </label>

        <input type="text" id="tag_box" name="tag_from_query" class="form-control">
      </div>

      <button class="btn btn-block btn-outline-secondary">
        Create tag
      </button>
    </form>
  </div>

  <%# Allow commenting %>
  <div class="col-md-4">
    <form action="/insert_user_comment" method="post">
      <div class="form-group">
        <input type="hidden" id="inventory_id" name="inventory_id_from_query" class="form-control" value=<%= @inventory.id%>>
      </div>

      <div class="form-group">
        <input type="hidden" id="wine_id_box" name="wine_id_from_query" class="form-control" value=<%= @inventory.wine_id%>>
      </div>

      <div class="form-group">
        <label for="comment_box">
          Comment
        </label>

        <textarea id="comment_box" name="comment_from_query" class="form-control" rows="3"></textarea>
      </div>

      <button class="btn btn-block btn-outline-secondary">
        Comment
      </button>
    </form>
  </div>

</div>

<a href="/delete_inventory/<%= @inventory.id %>">
  Delete inventory
</a>


